(()=>{var C=function(e){return new Promise(t=>{var n=document.createElement("script");n.src=e,n.onload=()=>{t()},document.head.appendChild(n)})},k=function(e){return new Promise(t=>{var n=document.createElement("link");n.href=e,n.type="text/css",n.rel="stylesheet",n.onload=()=>{t()},document.head.appendChild(n)})},I=function(e){for(var t=function(l){for(var s=l.childNodes,a=s.length,g=[],m,v,p,h,y=0;y<a;y++){if(m=s[y],m.nodeType!==1)continue;v=m.children[0],p=v.getAttribute("data-size").split("x"),h={src:v.getAttribute("href"),w:parseInt(p[0],10),h:parseInt(p[1],10)},m.children.length>1&&(h.title=m.children[1].innerHTML),v.children.length>0&&(h.msrc=v.children[0].getAttribute("src")),h.el=m,g.push(h)}return g},n=function l(s,a){return s&&(a(s)?s:l(s.parentNode,a))},r=function(l){l=l||window.event,l.preventDefault?l.preventDefault():l.returnValue=!1;var s=l.target||l.srcElement,a=n(s,function(w){return w.tagName&&w.tagName.toUpperCase()==="FIGURE"});if(!a)return;for(var g=a.parentNode,m=a.parentNode.childNodes,v=m.length,p=0,h,y=0;y<v;y++){if(m[y].nodeType!==1)continue;if(m[y]===a){h=p;break}p++}return h>=0&&d(h,g),!1},c=function(){var l=window.location.hash.substring(1),s={};if(l.length<5)return s;for(var a=l.split("&"),g=0;g<a.length;g++){if(!a[g])continue;var m=a[g].split("=");if(m.length<2)continue;s[m[0]]=m[1]}return s.gid&&(s.gid=parseInt(s.gid,10)),s},d=function(l,s,a,g){var m=document.querySelectorAll(".pswp")[0],v,p,h;if(h=t(s),p={galleryUID:s.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(w){var D=h[w].el.getElementsByTagName("img")[0],A=window.pageYOffset||document.documentElement.scrollTop,S=D.getBoundingClientRect();return{x:S.left,y:S.top+A,w:S.width}}},g)if(p.galleryPIDs){for(var y=0;y<h.length;y++)if(h[y].pid==l){p.index=y;break}}else p.index=parseInt(l,10)-1;else p.index=parseInt(l,10);if(isNaN(p.index))return;a&&(p.showAnimationDuration=0),v=new PhotoSwipe(m,PhotoSwipeUI_Default,h,p),v.init()},f=document.querySelectorAll(e),o=0,i=f.length;o<i;o++)f[o].setAttribute("data-pswp-uid",o+1),f[o].onclick=r;var u=c();u.pid&&u.gid&&d(u.pid,f[u.gid-1],!0,!0)};function T(e){let t=document.createElement("div");t.className="gallery";let n=e[0].parentNode,r=e[0];n.insertBefore(t,r);for(let c=0;c<e.length;++c){let d=e[c].querySelector("img").width,f=e[c].querySelector("img").height;e[c].style.flexGrow=`${d*100/f}`,e[c].style.flexBasis=`${d*240/f}px`,t.appendChild(e[c])}}function B(){let e=[C("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"),C("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"),k("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"),k("https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css")];return Promise.all(e)}function E(e){let t=document.querySelector(e).querySelectorAll("figure");if(t.length){let n=[t[0]];for(let r=1;r<t.length;++r)t[r].previousElementSibling===n[n.length-1]?n.push(t[r]):(T(n),n=[t[r]]);n.length>0&&T(n),B().then(()=>{let r=document.querySelector(".pswp");r.style.removeProperty("display"),I(`${e} .gallery`)})}}var b={};if(localStorage.hasOwnProperty("StackColorsCache"))try{b=JSON.parse(localStorage.getItem("StackColorsCache"))}catch(e){b={}}async function P(e,t,n){if(!e)return await Vibrant.from(n).getPalette();if(!b.hasOwnProperty(e)||b[e].hash!==t){let r=await Vibrant.from(n).getPalette();b[e]={hash:t,Vibrant:{hex:r.Vibrant.hex,rgb:r.Vibrant.rgb,bodyTextColor:r.Vibrant.bodyTextColor},DarkMuted:{hex:r.DarkMuted.hex,rgb:r.DarkMuted.rgb,bodyTextColor:r.DarkMuted.bodyTextColor}},localStorage.setItem("StackColorsCache",JSON.stringify(b))}return b[e]}var M=(e,t=500)=>{e.classList.add("transiting"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.offsetHeight,e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",window.setTimeout(()=>{e.classList.remove("show"),e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("transiting")},t)},q=(e,t=500)=>{e.classList.add("transiting"),e.style.removeProperty("display"),e.classList.add("show");let n=e.offsetHeight;e.style.overflow="hidden",e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0",e.style.marginTop="0",e.style.marginBottom="0",e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=n+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout(()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.classList.remove("transiting")},t)},H=(e,t=500)=>window.getComputedStyle(e).display==="none"?q(e,t):M(e,t);function L(){let e=document.getElementById("toggle-menu");e&&e.addEventListener("click",()=>{if(document.getElementById("main-menu").classList.contains("transiting"))return;document.body.classList.toggle("show-menu"),H(document.getElementById("main-menu"),300),e.classList.toggle("is-active")})}async function x(){let e;document.querySelector(".input-search")&&V(document.querySelector(".input-search"))}async function $(e,t){let n=[],r=[];for(var c=0;c<e.length;c++){let d=e[c];if(d.content.length==0)continue;d.title.toLowerCase().includes(t)?n.push(d):d.content.toLowerCase().includes(t)&&r.push(d)}return n.length>1?Promise.resolve(n):Promise.resolve(n.concat(r))}async function O(e,t){let n=[];return n=n.concat(await $(e,t)),Promise.resolve(n)}async function V(e){let t,n=0,r=await(await fetch("/index.json")).json();e.addEventListener("input",async function(){let o,i;if(e.value.length>2){t=-1;let u=await O(r,e.value.toLowerCase());if(n=u.length,u.length>0){f(),o=document.createElement("div"),o.setAttribute("id","autocomplete-list"),o.setAttribute("class","autocomplete-items"),this.parentNode.appendChild(o);for(let l=0;l<u.length;l++){let s=u[l];i=document.createElement("div"),i.innerHTML="<strong>"+s.title+"</strong></br>",i.innerHTML+=s.content.substring(0,20)+"...",i.addEventListener("click",function(a){window.location=s.permalink}.bind(s)),o.appendChild(i)}}}}),e.addEventListener("keydown",function(o){var i=document.getElementById("autocomplete-list");i&&(i=i.getElementsByTagName("div")),o.keyCode==40&&t<n?(t++,c(i)):o.keyCode==38&&t>0?(t--,c(i)):o.keyCode==13&&(o.preventDefault(),t>-1&&(i&&i[t].click()))});function c(o){if(!o)return!1;d(o),t>=o.length&&(t=0),t<0&&(t=o.length-1),o[t].classList.add("autocomplete-active")}function d(o){for(var i=0;i<o.length;i++)o[i].classList.remove("autocomplete-active")}function f(o){for(var i=document.getElementsByClassName("autocomplete-items"),u=0;u<i.length;u++)o!=i[u]&&o!=e&&i[u].parentNode.removeChild(i[u])}document.addEventListener("click",function(o){f(o.target)})}var N={init:()=>{L(),x(),document.querySelector(".article-content")&&E(".article-content"),document.querySelectorAll(".color-tag").forEach(async t=>{let n=t.getAttribute("data-image"),r=t.getAttribute("data-key"),c=t.getAttribute("data-hash"),d=await P(r,c,n);t.style.color=d.Vibrant.bodyTextColor,t.style.background=d.Vibrant.hex});let e=document.querySelector(".article-list--tile");if(e){let t=new IntersectionObserver(async(n,r)=>{n.forEach(c=>{if(!c.isIntersecting)return;r.unobserve(c.target);let d=c.target.querySelectorAll("article.has-image");d.forEach(async f=>{let o=f.querySelector("img"),i=o.src,u=o.getAttribute("data-key"),l=o.getAttribute("data-hash"),s=f.querySelector(".article-details"),a=await P(u,l,i);s.style.background=`
                        linear-gradient(0deg,
                            rgba(${a.DarkMuted.rgb[0]}, ${a.DarkMuted.rgb[1]}, ${a.DarkMuted.rgb[2]}, 0.5) 0%,
                            rgba(${a.Vibrant.rgb[0]}, ${a.Vibrant.rgb[1]}, ${a.Vibrant.rgb[2]}, 0.75) 100%)`})})});t.observe(e)}}};window.addEventListener("load",()=>{setTimeout(function(){N.init()},0)});window.Stack=N;})();
/*!
*   Hugo Theme Stack
*
*   @author: Jimmy Cai
*   @website: https://jimmycai.com
*   @link: https://github.com/CaiJimmy/hugo-theme-stack
*/
